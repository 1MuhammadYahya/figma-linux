name: Flatpak

on: workflow_dispatch

jobs:
  setup:
    name: Setup
    runs-on: ubuntu-latest
    steps:
      - name: Import SSH key
        id: key
        run: |
          echo "Importing SSH ley..."
          mkdir -p ~/.ssh
          echo "${{ secrets.ID_RSA }}" | base64 -d > ~/.ssh/id_rsa
          echo "Updating ~/.ssh/known_hosts..."
          ssh-keyscan -t rsa github.com >> ~/.ssh/known_hosts
          chmod 700 ~/.ssh
          chmod 600 ~/.ssh/id_rsa
          echo "Step completed"

      - name: Clone repo
        id: clone
        run: git clone git@github.com:flathub/io.github.Figma_Linux.figma_linux.git

      - name: Update configs
        id: update
        run: |
          node -v
          npm -v
          ls -la

      # - name: Push
      #   id: push
      #   run: |
      #     git config --global --add user.name "${{ secrets.USER_NAME }}"
      #     git config --global --add user.email "${{ secrets.EMAIL }}"
      #     git add .
      #     git commit -m "Release v$version"
      #     git push origin master
      # - name:  Create Pull Request
      #   run: |
      #     curl -X POST -u "ChugunovRoman:${{ secrets.REPO_ACCESS_TOKEN }}" -H "Accept: application/vnd.github.v3+json" https://api.github.com/repos/flathub/io.github.Figma_Linux.figma_linux/pulls -d '{"title": "Release v0.7.4 version","head":"Figma-Linux:bump-version","base":"master"}'

      # - uses: octokit/request-action@v2.x
      #   name: Create Pull Request
      #   id: cpr
      #   with:
      #     route: GET /repos/flathub/io.github.Figma_Linux.figma_linux/pulls
      #     body: '{"title": "Release v0.7.4 version","head":"Figma-Linux:bump-version","base":"master"}'
      #     data: '{"title": "Release v0.7.4 version","head":"Figma-Linux:bump-version","base":"master"}'
      #   env:
      #     GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
